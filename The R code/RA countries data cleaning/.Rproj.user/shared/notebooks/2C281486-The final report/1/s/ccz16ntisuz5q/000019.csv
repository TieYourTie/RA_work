"0",""
"0",""
"0","####"
"0","# Step 1: Filter rows where UN column equals 1"
"0","WB_HP_filter_data <- WB_stage_one_HP[WB_stage_one_HP$UN == 1, ]"
"0",""
"0","excluded_ISO_codes <- c("
"0","  ""IRQ"", ""OMN"", ""SOM"", ""YEM"", ""SSD"", ""COD"", ""SYR"", ""AFG"", ""SDN"", ""CAF"", ""TCD"", "
"0","  ""HTI"", ""ETH"", ""MMR"", ""MLI"", ""GIN"", ""NGA"", ""ZWE"", ""LBY"", ""UKR"", ""ERI"", ""BDI"", "
"0","  ""BFA"", ""MOZ"", ""CMR"", ""NER"", ""LBN"", ""UGA"", ""COG"", ""VEN"", ""LKA"", ""IRN"", ""BRN"", ""KWT"" , ""PRK"", ""GNQ"" "
"0",")"
"0",""
"0",""
"0",""
"0","# Step 2: Remove rows with ISO_code matching those in removed_countries$ISO_code"
"0","WB_HP_filter_data <- WB_HP_filter_data[!(WB_HP_filter_data$ISO_code %in% excluded_ISO_codes), ]"
"0",""
"0",""
"0","#create a new dataset base on the countries check list"
"0","WB_HP_filter_data <- WB_HP_filter_data[!(WB_HP_filter_data$LDC == 1 | "
"0","                                         WB_HP_filter_data$HPIC == 1 | "
"0","                                         WB_HP_filter_data$SIDS == 1 | "
"0","                                         WB_HP_filter_data$LLDC == 1), ]"
"0",""
"0",""
"0",""
"0",""
"0","# Calculate the number of countries"
"0","n <- nrow(WB_HP_filter_data)"
"0",""
"0",""
"0",""
"0","# Plot with specified adjustments and added space for the title"
"0","ggplot(WB_HP_filter_data, aes(y = Persistence_effect, x = AverageInflation)) +"
"0","  geom_point(color = ""blue"") +"
"0","  geom_smooth(method = ""lm"", se = FALSE, color = ""red"") + # Linear regression line"
"0","  labs("
"0","    title = ""Persistence Effect vs Average Inflation (HP)"","
"0","    x = ""Average Inflation"","
"0","    y = ""Persistence Effect"","
"0","    caption = paste(""n ="", n, ""\nData source: World Bank"")"
"0","  ) +"
"0","  ylim(min(WB_stage_one_HP$Persistence_effect) - 0.2, max(WB_stage_one_HP$Persistence_effect) + 0.2) + # Set y-axis limits"
"0","  theme_economist() + # Economist theme"
"0","  theme("
"0","    plot.title = element_text(hjust = 0.5, margin = margin(b = 10)), # Increase bottom margin of title"
"0","    plot.caption = element_text(hjust = 0, vjust = 1, face = ""italic""), # Position caption in bottom-left"
"0","    plot.margin = margin(t = 20) # Add extra margin above the plot"
"0",""
"0",""
"0",""
"0","  )"
"1","[38;5;232m`geom_smooth()` using formula = 'y ~ x'[39m
"
