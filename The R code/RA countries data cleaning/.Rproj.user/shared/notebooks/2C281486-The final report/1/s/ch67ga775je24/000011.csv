"0",""
"0","# Calculate the number of countries"
"0","n <- nrow(WB_stage_one_HP)"
"0",""
"0","# Find the top 3 countries with the highest average inflation"
"0","top_countries <- WB_stage_one_HP %>%"
"0","  arrange(desc(AverageInflation)) %>%"
"0","  head(3) # Adjust the number of countries as desired"
"0",""
"0","# Plot with specified adjustments and added space for the title"
"0","ggplot(WB_stage_one_HP, aes(y = Persistence_effect, x = AverageInflation)) +"
"0","  geom_point(color = ""blue"") +"
"0","  geom_smooth(method = ""lm"", se = FALSE, color = ""red"") + # Linear regression line"
"0","  labs("
"0","    title = ""Persistence Effect vs Average Inflation (HP)"","
"0","    x = ""Average Inflation"","
"0","    y = ""Persistence Effect"","
"0","    caption = paste(""n ="", n, ""\nData source: World Bank"")"
"0","  ) +"
"0","  ylim(min(WB_stage_one_HP$Persistence_effect) - 0.2, max(WB_stage_one_HP$Persistence_effect) + 0.2) + # Set y-axis limits"
"0","  theme_economist() + # Economist theme"
"0","  theme("
"0","    plot.title = element_text(hjust = 0.5, margin = margin(b = 10)), # Increase bottom margin of title"
"0","    plot.caption = element_text(hjust = 0, vjust = 1, face = ""italic""), # Position caption in bottom-left"
"0","    plot.margin = margin(t = 20) # Add extra margin above the plot"
"0","  )"
"1","[38;5;232m`geom_smooth()` using formula = 'y ~ x'[39m
"
